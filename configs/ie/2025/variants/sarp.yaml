meta:
  variant: "sarp"
  label: "SARP (Special Assignee Relief Programme)"
  description: "30% relief on income above €100,000 for qualifying foreign assignees. Relief applies only to income tax calculation; USC and PRSI still apply to full income."
  base: "base.yaml"
  sources:
    - "https://www.revenue.ie/en/personal-tax-credits-reliefs-and-exemptions/income-and-employment/special-assignee-relief-programme/index.aspx"
    - "https://kpmg.com/ie/en/insights/tax/sarp-special-assignee-relief-programme-tax.html"

parameters:
  sarp_threshold: 100000
  sarp_relief_rate: 0.30
  sarp_income_cap: 1000000

calculations:
  # Calculate SARP relief amount for breakdown display
  - id: "sarp_relief"
    label: "SARP Relief (30%)"
    type: "mul"
    values:
      - type: "max"
        values:
          - 0
          - type: "min"
            values:
              - type: "sub"
                values:
                  - "@gross_annual"
                  - "$sarp_threshold"
              - type: "sub"
                values:
                  - "$sarp_income_cap"
                  - "$sarp_threshold"
      - "$sarp_relief_rate"
    category: "deduction"

  # Override income_at_standard_rate with SARP adjustment inlined
  - id: "income_at_standard_rate"
    label: "Income Taxed at Standard Rate"
    type: "min"
    values:
      - type: "sub"
        values:
          - "@gross_annual"
          - type: "mul"
            values:
              - type: "max"
                values:
                  - 0
                  - type: "min"
                    values:
                      - type: "sub"
                        values:
                          - "@gross_annual"
                          - "$sarp_threshold"
                      - type: "sub"
                        values:
                          - "$sarp_income_cap"
                          - "$sarp_threshold"
              - "$sarp_relief_rate"
      - "$standard_rate_band"
    category: "income_tax"

  # Override income_at_higher_rate with SARP adjustment inlined
  - id: "income_at_higher_rate"
    label: "Income Taxed at Higher Rate"
    type: "sub"
    values:
      - type: "sub"
        values:
          - "@gross_annual"
          - type: "mul"
            values:
              - type: "max"
                values:
                  - 0
                  - type: "min"
                    values:
                      - type: "sub"
                        values:
                          - "@gross_annual"
                          - "$sarp_threshold"
                      - type: "sub"
                        values:
                          - "$sarp_income_cap"
                          - "$sarp_threshold"
              - "$sarp_relief_rate"
      - "$income_at_standard_rate"
    category: "income_tax"

outputs:
  breakdown:
    taxes:
      - "$income_tax"
    contributions:
      - "$usc"
      - "$prsi"
    credits:
      - "$personal_credit"
      - "$employee_credit"
    deductions:
      - "$sarp_relief"

notices:
  - type: "warning"
    message: "SARP relief only reduces income tax. USC and PRSI are still calculated on your full gross income."

  - type: "info"
    message: "SARP provides 30% relief on income between €100,000 and €1,000,000. Minimum salary of €100,000 required for eligibility."

  - type: "info"
    message: "SARP is available for up to 5 consecutive tax years. The program is currently scheduled to end December 31, 2025 for new entrants."

  - type: "info"
    message: "Additional eligibility requirements apply: prior 6-month employment abroad, 12-month assignment duration, and employer notification within 90 days of arrival."
